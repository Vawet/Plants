import{c as R,g as W}from"./unhead-C_h-0uJb.js";import{n as K,i as B,v as V,u as k,r as S,w as q,b as F,e as G,f as N,g as J,h as z}from"./@vue-CisjAB5t.js";const Q=new Set(["title","titleTemplate","script","style","noscript"]),H=new Set(["base","meta","link","style","script","noscript"]),X=new Set(["title","titleTemplate","templateParams","base","htmlAttrs","bodyAttrs","meta","link","style","script","noscript"]),Y=new Set(["base","title","titleTemplate","bodyAttrs","htmlAttrs","templateParams"]),j=new Set(["tagPosition","tagPriority","tagDuplicateStrategy","children","innerHTML","textContent","processTemplateParams"]),be=typeof window<"u";function ge(e){return e}function C(e){let t=9;for(let n=0;n<e.length;)t=Math.imul(t^e.charCodeAt(n++),9**9);return((t^t>>>9)+65536).toString(16).substring(1,8).toLowerCase()}function M(e){if(e._h)return e._h;if(e._d)return C(e._d);let t=`${e.tag}:${e.textContent||e.innerHTML||""}:`;for(const n in e.props)t+=`${n}:${String(e.props[n])},`;return C(t)}function Z(e,t){return e instanceof Promise?e.then(t):t(e)}function A(e,t,n,o){const s=o||$(typeof t=="object"&&typeof t!="function"&&!(t instanceof Promise)?{...t}:{[e==="script"||e==="noscript"||e==="style"?"innerHTML":"textContent"]:t},e==="templateParams"||e==="titleTemplate");if(s instanceof Promise)return s.then(i=>A(e,t,n,i));const r={tag:e,props:s};for(const i of j){const f=r.props[i]!==void 0?r.props[i]:n[i];f!==void 0&&((!(i==="innerHTML"||i==="textContent"||i==="children")||Q.has(r.tag))&&(r[i==="children"?"innerHTML":i]=f),delete r.props[i])}return r.props.body&&(r.tagPosition="bodyClose",delete r.props.body),r.tag==="script"&&typeof r.innerHTML=="object"&&(r.innerHTML=JSON.stringify(r.innerHTML),r.props.type=r.props.type||"application/json"),Array.isArray(r.props.content)?r.props.content.map(i=>({...r,props:{...r.props,content:i}})):r}function ee(e,t){const n=e==="class"?" ":";";return t&&typeof t=="object"&&!Array.isArray(t)&&(t=Object.entries(t).filter(([,o])=>o).map(([o,s])=>e==="style"?`${o}:${s}`:o)),String(Array.isArray(t)?t.join(n):t)?.split(n).filter(o=>!!o.trim()).join(n)}function D(e,t,n,o){for(let s=o;s<n.length;s+=1){const r=n[s];if(r==="class"||r==="style"){e[r]=ee(r,e[r]);continue}if(e[r]instanceof Promise)return e[r].then(i=>(e[r]=i,D(e,t,n,s)));if(!t&&!j.has(r)){const i=String(e[r]),f=r.startsWith("data-");i==="true"||i===""?e[r]=f?"true":!0:e[r]||(f&&i==="false"?e[r]="false":delete e[r])}}}function $(e,t=!1){const n=D(e,t,Object.keys(e),0);return n instanceof Promise?n.then(()=>e):e}const te=10;function U(e,t,n){for(let o=n;o<t.length;o+=1){const s=t[o];if(s instanceof Promise)return s.then(r=>(t[o]=r,U(e,t,o)));Array.isArray(s)?e.push(...s):e.push(s)}}function ve(e){const t=[],n=e.resolvedInput;for(const s in n){if(!Object.prototype.hasOwnProperty.call(n,s))continue;const r=n[s];if(!(r===void 0||!X.has(s))){if(Array.isArray(r)){for(const i of r)t.push(A(s,i,e));continue}t.push(A(s,r,e))}}if(t.length===0)return[];const o=[];return Z(U(o,t,0),()=>o.map((s,r)=>(s._e=e._i,e.mode&&(s._m=e.mode),s._p=(e._i<<te)+r,s)))}const Te=new Set(["onload","onerror","onabort","onprogress","onloadstart"]),x={base:-10,title:10},O={critical:-80,high:-10,low:20};function we(e){const t=e.tagPriority;if(typeof t=="number")return t;let n=100;return e.tag==="meta"?e.props["http-equiv"]==="content-security-policy"?n=-30:e.props.charset?n=-20:e.props.name==="viewport"&&(n=-15):e.tag==="link"&&e.props.rel==="preconnect"?n=20:e.tag in x&&(n=x[e.tag]),t&&t in O?n+O[t]:n}const Pe=[{prefix:"before:",offset:-1},{prefix:"after:",offset:1}],ne=["name","property","http-equiv"];function oe(e){const{props:t,tag:n}=e;if(Y.has(n))return n;if(n==="link"&&t.rel==="canonical")return"canonical";if(t.charset)return"charset";if(t.id)return`${n}:id:${t.id}`;for(const o of ne)if(t[o]!==void 0)return`${n}:${o}:${t[o]}`;return!1}const h="%separator";function re(e,t,n=!1){let o;if(t==="s"||t==="pageTitle")o=e.pageTitle;else if(t.includes(".")){const s=t.indexOf(".");o=e[t.substring(0,s)]?.[t.substring(s+1)]}else o=e[t];if(o!==void 0)return n?(o||"").replace(/"/g,'\\"'):o||""}const se=new RegExp(`${h}(?:\\s*${h})*`,"g");function He(e,t,n,o=!1){if(typeof e!="string"||!e.includes("%"))return e;let s=e;try{s=decodeURI(e)}catch{}const r=s.match(/%\w+(?:\.\w+)?/g);if(!r)return e;const i=e.includes(h);return e=e.replace(/%\w+(?:\.\w+)?/g,f=>{if(f===h||!r.includes(f))return f;const g=re(t,f.slice(1),o);return g!==void 0?g:f}).trim(),i&&(e.endsWith(h)&&(e=e.slice(0,-h.length)),e.startsWith(h)&&(e=e.slice(h.length)),e=e.replace(se,n).trim()),e}function Ae(e,t){return e==null?t||null:typeof e=="function"?e(t):e}async function ie(e,t={}){const n=t.document||e.resolvedOptions.document;if(!n||!e.dirty)return;const o={shouldRender:!0,tags:[]};if(await e.hooks.callHook("dom:beforeRender",o),!!o.shouldRender)return e._domUpdatePromise||(e._domUpdatePromise=new Promise(async s=>{const r=(await e.resolveTags()).map(a=>({tag:a,id:H.has(a.tag)?M(a):a.tag,shouldRender:!0}));let i=e._dom;if(!i){i={elMap:{htmlAttrs:n.documentElement,bodyAttrs:n.body}};const a=new Set;for(const c of["body","head"]){const l=n[c]?.children;for(const u of l){const d=u.tagName.toLowerCase();if(!H.has(d))continue;const y={tag:d,props:await $(u.getAttributeNames().reduce((v,w)=>({...v,[w]:u.getAttribute(w)}),{})),innerHTML:u.innerHTML},b=oe(y);let p=b,T=1;for(;p&&a.has(p);)p=`${b}:${T++}`;p&&(y._d=p,a.add(p)),i.elMap[u.getAttribute("data-hid")||M(y)]=u}}}i.pendingSideEffects={...i.sideEffects},i.sideEffects={};function f(a,c,l){const u=`${a}:${c}`;i.sideEffects[u]=l,delete i.pendingSideEffects[u]}function g({id:a,$el:c,tag:l}){const u=l.tag.endsWith("Attrs");if(i.elMap[a]=c,u||(l.textContent&&l.textContent!==c.textContent&&(c.textContent=l.textContent),l.innerHTML&&l.innerHTML!==c.innerHTML&&(c.innerHTML=l.innerHTML),f(a,"el",()=>{i.elMap[a]?.remove(),delete i.elMap[a]})),l._eventHandlers)for(const d in l._eventHandlers)Object.prototype.hasOwnProperty.call(l._eventHandlers,d)&&c.getAttribute(`data-${d}`)!==""&&((l.tag==="bodyAttrs"?n.defaultView:c).addEventListener(d.substring(2),l._eventHandlers[d].bind(c)),c.setAttribute(`data-${d}`,""));for(const d in l.props){if(!Object.prototype.hasOwnProperty.call(l.props,d))continue;const y=l.props[d],b=`attr:${d}`;if(d==="class"){if(!y)continue;for(const p of y.split(" "))u&&f(a,`${b}:${p}`,()=>c.classList.remove(p)),!c.classList.contains(p)&&c.classList.add(p)}else if(d==="style"){if(!y)continue;for(const p of y.split(";")){const T=p.indexOf(":"),v=p.substring(0,T).trim(),w=p.substring(T+1).trim();f(a,`${b}:${v}`,()=>{c.style.removeProperty(v)}),c.style.setProperty(v,w)}}else c.getAttribute(d)!==y&&c.setAttribute(d,y===!0?"":String(y)),u&&f(a,b,()=>c.removeAttribute(d))}}const _=[],m={bodyClose:void 0,bodyOpen:void 0,head:void 0};for(const a of r){const{tag:c,shouldRender:l,id:u}=a;if(l){if(c.tag==="title"){n.title=c.textContent;continue}a.$el=a.$el||i.elMap[u],a.$el?g(a):H.has(c.tag)&&_.push(a)}}for(const a of _){const c=a.tag.tagPosition||"head";a.$el=n.createElement(a.tag.tag),g(a),m[c]=m[c]||n.createDocumentFragment(),m[c].appendChild(a.$el)}for(const a of r)await e.hooks.callHook("dom:renderTag",a,n,f);m.head&&n.head.appendChild(m.head),m.bodyOpen&&n.body.insertBefore(m.bodyOpen,n.body.firstChild),m.bodyClose&&n.body.appendChild(m.bodyClose);for(const a in i.pendingSideEffects)i.pendingSideEffects[a]();e._dom=i,await e.hooks.callHook("dom:rendered",{renders:r}),s()}).finally(()=>{e._domUpdatePromise=void 0,e.dirty=!1})),e._domUpdatePromise}function ae(e,t={}){const n=t.delayFn||(o=>setTimeout(o,10));return e._domDebouncedUpdatePromise=e._domDebouncedUpdatePromise||new Promise(o=>n(()=>ie(e,t).then(()=>{delete e._domDebouncedUpdatePromise,o()})))}function _e(e){return t=>{const n=t.resolvedOptions.document?.head.querySelector('script[id="unhead:payload"]')?.innerHTML||!1;return n&&t.push(JSON.parse(n)),{mode:"client",hooks:{"entries:updated":o=>{ae(o,e)}}}}}const ce=V[0]==="3";function le(e){return typeof e=="function"?e():k(e)}function P(e){if(e instanceof Promise||e instanceof Date||e instanceof RegExp)return e;const t=le(e);if(!e||!t)return t;if(Array.isArray(t))return t.map(n=>P(n));if(typeof t=="object"){const n={};for(const o in t)if(Object.prototype.hasOwnProperty.call(t,o)){if(o==="titleTemplate"||o[0]==="o"&&o[1]==="n"){n[o]=k(t[o]);continue}n[o]=P(t[o])}return n}return t}const fe={hooks:{"entries:resolve":e=>{for(const t of e.entries)t.resolvedInput=P(t.input)}}},I="usehead";function de(e){return{install(n){ce&&(n.config.globalProperties.$unhead=e,n.config.globalProperties.$head=e,n.provide(I,e))}}.install}function Se(e={}){e.domDelayFn=e.domDelayFn||(n=>K(()=>setTimeout(()=>n(),0)));const t=R(e);return t.use(fe),t.install=de(t),t}const L=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},E="__unhead_injection_handler__";function ue(){return E in L?L[E]():B(I)||W()}function pe(e,t={}){const n=t.head||ue();if(n)return n.ssr?n.push(e,t):ye(n,e,t)}function ye(e,t,n={}){const o=S(!1),s=S({});q(()=>{s.value=o.value?{}:P(t)});const r=e.push(s.value,n);return F(s,f=>{r.patch(f)}),z()&&(G(()=>{r.dispose()}),N(()=>{o.value=!0}),J(()=>{o.value=!1})),r}function Ce(e){const t=e;return t.headTags=e.resolveTags,t.addEntry=e.push,t.addHeadObjs=e.push,t.addReactiveEntry=(n,o)=>{const s=pe(n,o);return s!==void 0?s.dispose:()=>{}},t.removeHeadObjs=()=>{},t.updateDOM=()=>{e.hooks.callHook("entries:updated",e)},t.unhead=e,t}export{_e as D,H,be as I,Te as N,Pe as S,oe as a,C as b,Se as c,ge as d,He as e,M as h,ve as n,Ce as p,Ae as r,we as t};
